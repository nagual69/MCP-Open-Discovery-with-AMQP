# MCP Tool Builder - Complete User Guide üõ†Ô∏è

A comprehensive guide to using the interactive MCP Tool Builder for creating professional MCP server tools.

## üöÄ Quick Start

### Prerequisites

- **MCP Open Discovery** server installed and running
- Basic understanding of JavaScript/Node.js
- Familiarity with MCP (Model Context Protocol) concepts

### Access the Tool Builder

1. Start the development server: `cd apps/web && pnpm dev`
2. Open your browser to: `http://localhost:3000/builder`
3. You'll see the interactive tool builder interface

## üé® Interface Overview

### **Header**

- **Back to Home**: Return to the main page
- **MCP Tool Builder**: Current page title
- **Download ZIP**: Download your customized tool

### **Template Selection**

Choose from 4 professional templates:

- üèÅ **Basic Hello World** (Basic)
- üåê **Network Discovery Tools** (Network)
- üíæ **Memory CMDB System** (CMDB)
- üîå **REST API Client** (Integration)

### **Tool Configuration**

- **Tool Name Input**: Sets the base name for your tool files
- **Monaco Editor**: Professional code editor with syntax highlighting
- **Tab Navigation**: Switch between `package.json` and `index.js`

### **Live Preview Panel**

- **Template Information**: Current template details
- **Validation Status**: Real-time error checking
- **Tool Overview**: Parsed configuration summary
- **Deployment Guide**: Step-by-step deployment instructions

### Manifest (Capabilities & Packaging)

The builder includes an optional Manifest editor that produces a `mcp-plugin.json` compatible with schema v1 (legacy) or v2 (integrity). Current UI emits the minimal v2 shape when possible:

Key fields (v2):
- `manifestVersion`: always set to `"2"` when integrity data is included.
- `name`, `version`, `entry`: core identity + main module under `dist/`.
- `capabilities`: tools / resources / prompts declarations (used for load reconciliation).
- `permissions`: advisory booleans (`network`, `fsRead`, etc.).
- `dist.hash`: computed SHA256 of ordered `dist/` contents (builder computes before ZIP creation).
- `dependenciesPolicy`: defaults to `bundled-only`.

Capabilities Editor Inputs:
- Resources: `name`, optional `title`, `uriTemplate` (e.g. `mcp://assets/{id}`).
- Prompts: `name`, optional `title` / `description`, optional `argsSchema` JSON.
- Dependencies: comma-separated plugin IDs.

External Dependencies:
- Not yet generated by the builder UI (future). For now all bundles are enforced as self-contained; `externalDependencies` omitted.
- Runtime external deps require environment flag `PLUGIN_ALLOW_RUNTIME_DEPS=1` and allowlist approval.

Validation:
- Builder validates manifest JSON; download blocked on errors with inline diagnostics.
- `dist.hash` is inserted after hashing files destined for the ZIP archive to ensure reproducibility.

## üìù Step-by-Step Tutorial

### **Step 1: Choose Your Template**

#### üèÅ **Basic Hello World** - Best for beginners

```javascript
// Simple greeting tool with customizable messages
hello_world({
  name: "Alice",
  greeting: "Hello",
});
// Returns: "Hello, Alice! Welcome to MCP Open Discovery tools."
```

#### üåê **Network Discovery Tools** - For infrastructure monitoring

```javascript
// Network utilities with security features
ping({ host: "google.com", count: 4 });
nslookup({ domain: "example.com", type: "A" });
test_port({ host: "192.168.1.1", port: 22 });
```

#### üíæ **Memory CMDB System** - For configuration management

```javascript
// In-memory database with persistence
memory_set({
  key: "ci:host:web01",
  value: { ip: "192.168.1.10", role: "web" },
});
memory_get({ key: "ci:host:web01" });
memory_query({ pattern: "ci:host:*" });
```

#### üîå **REST API Client** - For service integration

```javascript
// REST API operations with authentication
http_get({
  url: "https://api.example.com/data",
  headers: { Authorization: "Bearer token" },
});
http_post({
  url: "https://api.example.com/webhook",
  body: { event: "deploy" },
});
api_health_check({ url: "https://api.example.com" });
```

### **Step 2: Customize Your Tool**

1. **Set Tool Name**: Enter a descriptive name (e.g., "my-network-monitor")
2. **Preview Filenames**: See the generated filenames with timestamps
3. **Edit Configuration**: Click on `package.json` tab to modify metadata
4. **Customize Code**: Click on `index.js` tab to modify tool behavior

#### **Common Customizations:**

**Update package.json:**

```json
{
  "name": "my-custom-tool",
  "version": "1.0.0",
  "description": "My custom MCP tool for specific use case",
  "author": "Your Name"
}
```

**Modify tool parameters:**

```javascript
// Change validation schemas
{
  host: z.string().describe('Target hostname or IP address'),
  timeout: z.number().min(1).max(60).default(10)
}
```

**Add new functionality:**

```javascript
// Add additional tools to the server
this.server.tool(
  "my_custom_tool",
  "Description of what this tool does",
  {
    /* Zod schema */
  },
  async (params) => {
    /* Implementation */
  }
);
```

### **Step 3: Validate Your Tool**

The tool builder provides real-time validation:

#### **‚úÖ Valid Configuration**

- Green checkmark with "Valid MCP Tool Configuration"
- Tool overview shows parsed details
- Download button is ready

#### **‚ùå Invalid Configuration**

- Red error messages with specific issues
- Common errors:
  - Missing required fields in package.json
  - Invalid JSON syntax
  - Missing MCP SDK dependency

### **Step 4: Download Your Tool**

1. Click **"Download ZIP"** button
2. You'll get a file named: `tool-name_YYYY-MM-DD_HHMMSS.zip`
3. The ZIP contains:
  - `package.json` - Dependencies and metadata
  - `tool-name_YYYY-MM-DD_HHMMSS.js` - Your tool implementation
  - `README.md` - Deployment instructions
  - `mcp-plugin.json` - v2 manifest (if valid) including computed `dist.hash`

Hash Determinism:
- File list sorted lexicographically before hashing.
- Hash prefix format: `sha256:<64hex>`.
- Re-building without modifying contents yields identical hash.

## üöÄ Deployment to MCP Open Discovery

### **Prerequisites**

- MCP Open Discovery server installed and running
- Access to the server's `tools/` directory
- Ability to restart the MCP server

### **Deployment Steps**

1. **Extract the ZIP file**

   ```bash
   unzip my-tool_2025-01-23_143052.zip
   ```

2. **Locate the tool file**

   ```bash
   # You'll see: my-tool_2025-01-23_143052.js
   ls -la *.js
   ```

3. **Copy to MCP Open Discovery**

   ```bash
   cp my-tool_2025-01-23_143052.js /path/to/mcp-open-discovery/tools/
   ```

4. **Restart MCP Open Discovery server**

   ```bash
   # Method depends on your setup
   systemctl restart mcp-open-discovery
   # OR
   pm2 restart mcp-open-discovery
   # OR
   docker-compose restart mcp-server
   ```

5. **Verify deployment**
   - Check MCP Open Discovery web interface
   - Tool should appear in available tools list
   - Test tool functionality through the interface

### **Alternative: Standalone Deployment**

For non-MCP Open Discovery deployments:

1. **Extract and install**

   ```bash
   unzip my-tool_2025-01-23_143052.zip
   cd my-tool_2025-01-23_143052
   npm install
   ```

2. **Test the tool**

   ```bash
   npm start
   ```

3. **Configure your MCP client**
   - Point your MCP client to the tool's endpoint
   - Follow your MCP client's configuration instructions

## üîí Safety Features

### **Filename Safety**

- **Timestamped filenames**: Prevent overwrites
- **Character sanitization**: Cross-platform compatibility
- **Preview generation**: See filenames before download

### **Code Safety**

- **Template validation**: Professional, tested code patterns
- **Input sanitization**: Prevent command injection in network tools
- **Error handling**: Comprehensive error management
- **Type safety**: Zod schemas for runtime validation

### **Deployment & Packaging Safety**

- **No remote execution**: Tools are downloaded, not executed.
- **Transparent code**: All code is visible and editable.
- **Integrity metadata**: `dist.hash` included for v2 manifests; verify with `scripts/validate-plugin.js`.
- **Bundled-only policy**: Builder emits fully self-contained bundles (no external runtime deps).
- **Documentation**: Complete setup instructions included.
- **Isolation**: Tools run in their own process space (future sandbox tiers will add stronger boundaries).

## üõ†Ô∏è Advanced Usage

### **Creating Custom Templates**

While the tool builder doesn't yet support custom template creation through the UI, you can modify existing templates:

1. Choose the closest existing template
2. Download and extract the tool
3. Modify the code as needed
4. Use as a starting point for future tools

### **Template Modification Examples**

#### **Adding Authentication to API Client**

```javascript
// Add API key authentication
const headers = {
  Authorization: `Bearer ${process.env.API_KEY}`,
  "X-API-Version": "2024-01-01",
  ...customHeaders,
};
```

#### **Extending Network Tools**

```javascript
// Add traceroute functionality
this.server.tool(
  "traceroute",
  "Trace network route to destination",
  {
    host: z.string().describe("Target hostname or IP"),
    maxHops: z.number().min(1).max(30).default(15),
  },
  async ({ host, maxHops }) => {
    // Implementation
  }
);
```

#### **Enhancing CMDB with Search**

```javascript
// Add full-text search capability
this.server.tool(
  "memory_search",
  "Search CI data using text queries",
  {
    query: z.string().describe("Search query"),
    fields: z.array(z.string()).optional(),
  },
  async ({ query, fields }) => {
    // Implementation with fuzzy matching
  }
);
```

## üêõ Troubleshooting

### **Common Issues**

#### **"Invalid JSON syntax" error**

- Check for missing commas or quotes in package.json
- Use the Monaco Editor's built-in JSON validation
- Ensure proper JSON formatting

#### **"Missing MCP SDK dependency" error**

- Verify `@modelcontextprotocol/sdk` is in dependencies
- Check version compatibility
- Ensure proper package.json structure

#### **Tool not loading in MCP Open Discovery**

- Verify file was copied to correct `tools/` directory
- Check file permissions (should be readable)
- Restart MCP Open Discovery server
- Check server logs for errors

#### **Download not working**

- Ensure browser allows downloads
- Check for popup blockers
- Try a different browser
- Verify JavaScript is enabled

### **Getting Help**

1. **Check the validation panel** - Real-time error messages
2. **Review generated README** - Complete deployment instructions
3. **Test standalone first** - Use `npm start` to verify tool works
4. **Check MCP Open Discovery logs** - Server-side error information

## üéØ Best Practices

### **Tool Design**

- **Clear naming**: Use descriptive tool and parameter names
- **Good documentation**: Add meaningful descriptions to Zod schemas
- **Error handling**: Always return proper CallToolResult format
- **Input validation**: Use Zod schemas to validate all inputs

### **Security**

- **Sanitize inputs**: Especially for network tools and file operations
- **Limit scope**: Only request necessary permissions
- **Validate data**: Use type checking and bounds checking
- **Handle errors gracefully**: Don't expose sensitive information

### **Performance**

- **Timeout handling**: Set reasonable timeouts for network operations
- **Resource limits**: Limit memory usage and file sizes
- **Async operations**: Use proper async/await patterns
- **Cleanup**: Close connections and free resources

## üöÄ Future Features

Coming soon:

- **Custom template creation** through the UI
- **Tool testing sandbox** (vm / worker based) for safe testing
- **External dependency declaration UI** with allowlist diffing
- **Dependency management & version advice**
- **Code snippets library** for common patterns
- **Import/Export functionality** for sharing tools
- **Signature generation** (optional signing workflow)
- **Marketplace integration** for discovering community tools

---

**Happy tool building! üéâ**

For more information, visit the [main repository](https://github.com/nagual69/mcp-open-discovery-tool-builder).

## Appendix: MCP OD Plugin Spec

See `docs/specs/mcp-plugin-spec.md` for the standardized plugin manifest and packaging format used by the Marketplace and the MCP Open Discovery Registry.
For hashing & validation details see forthcoming `PLUGIN_PACKAGING.md` (or the packaging section in architecture docs).
